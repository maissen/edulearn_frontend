<!-- ğŸŒ Navbar -->
<app-navbar></app-navbar>

<!-- ğŸ“š Contenu principal -->
<div class="manage-courses-page">

  <header class="page-header">
    <h1>ğŸ“š GÃ©rer mes cours</h1>
    <p>CrÃ©ez, Ã©ditez et supprimez vos contenus pÃ©dagogiques.</p>
  </header>

  <!-- Formulaire -->
  <section class="create-course-form">
    <div class="form-card">
      <h2>
        @if (mode === 'create') {
          â• CrÃ©er un nouveau cours
        } @else {
          âœï¸ Modifier le cours "{{ oldCourse.title }}"
        }
      </h2>

      <form (ngSubmit)="onCreateCourse()">
        <!-- Titre -->
        <div class="form-group">
          <label>Titre du cours</label>
          <input type="text" [(ngModel)]="oldCourse.title" name="title" required>
        </div>

        <div class="form-group">
          <label>Description</label>
          <textarea [(ngModel)]="newCourse.description" name="description" rows="3"></textarea>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>CatÃ©gorie</label>
            <select [(ngModel)]="oldCourse.category" name="category">
              <option value="">SÃ©lectionner...</option>
              <option value="programming">ğŸ’» Programmation</option>
              <option value="math">ğŸ“ MathÃ©matiques</option>
              <option value="design">ğŸ¨ Design UX/UI</option>
              <option value="science">ğŸ”¬ Sciences</option>
            </select>
          </div>
          <div class="form-group">
            <label>DurÃ©e (heures)</label>
            <input type="number" [(ngModel)]="oldCourse.duration" name="duration" min="1">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>Image de couverture (URL)</label>
            <input type="text" [(ngModel)]="oldCourse.imageUrl" name="imageUrl">
          </div>
          <div class="form-group">
            <label>URL vidÃ©o (YouTube/Vimeo)</label>
            <input type="text" [(ngModel)]="oldCourse.videoUrl" name="videoUrl"
                   placeholder="https://www.youtube.com/embed/...">
          </div>
        </div>

        <!-- Quiz -->
        <div class="quiz-section">
          <h3>ğŸ§  Practice Quiz</h3>
          <div *ngIf="oldCourse.quizzes.length === 0" class="empty-quiz">
            Aucun quiz. Cliquez sur "+ Ajouter un quiz".
          </div>
          <div class="quiz-list">
            <div class="quiz-item" *ngFor="let quiz of oldCourse.quizzes; let i = index">
              <div class="quiz-header">
                <h4>Quiz {{ i + 1 }}</h4>
                <button type="button" class="btn-delete" (click)="removeQuiz(i)">ğŸ—‘ï¸</button>
              </div>
              <div class="quiz-body">
                <div class="form-group">
                  <label>Question</label>
                  <input type="text" 
                         [(ngModel)]="oldCourse.quizzes[i].question" 
                         [name]="'quiz_' + i + '_question'" required>
                </div>
                <div class="options">
                  <div *ngFor="let opt of quiz.options; let j = index" class="option-row">
                    <label>Option {{ j + 1 }}</label>
                    <input type="text" 
                           [(ngModel)]="oldCourse.quizzes[i].options[j]" 
                           [name]="'quiz_' + i + '_opt_' + j">
                  </div>
                </div>
                <div class="form-group">
                  <label>Bonne rÃ©ponse (indice 0 Ã  {{ quiz.options.length - 1 }})</label>
                  <input type="number" 
                         [(ngModel)]="oldCourse.quizzes[i].correctAnswer" 
                         [name]="'quiz_' + i + '_correct'" 
                         [min]="0" 
                         [max]="quiz.options.length - 1">
                </div>
              </div>
            </div>
          </div>
          <button type="button" class="btn-add-quiz" (click)="addQuiz()">+ Ajouter un quiz</button>
        </div>

        <div class="form-actions">
          <button type="submit" class="btn-create">
            @if (mode === 'create') {
              ğŸš€ CrÃ©er le cours
            } @else {
              âœ… Mettre Ã  jour
            }
          </button>
          @if (mode === 'edit') {
            <button type="button" class="btn-cancel" (click)="resetForm()">âŒ Annuler</button>
          }
        </div>
      </form>
    </div>
  </section>

  <!-- Liste des cours -->
  <section class="courses-list">
    <h2>ğŸ“Œ Mes cours ({{ courses.length }})</h2>
    <div *ngIf="courses.length === 0" class="empty-state">
      Aucun cours. CrÃ©ez-en un !
    </div>
    <div class="course-grid">
      <div class="course-card" *ngFor="let course of courses">
        <div class="course-media">
          <img [src]="'https://via.placeholder.com/300x180/F5F7FA/555?text=No+Image'" 
                [alt]="course.titre">
          <div class="badge-video">ğŸ¥</div>
          <div class="badge-quiz">ğŸ§  0</div>
        </div>
        <div class="course-info">
          <h3>{{ course.titre }}</h3>
          <p>{{ course.description | slice:0:80 }}â€¦</p>
          <div class="course-meta">
            <span class="category">General</span>
            <span class="duration">1h</span>
          </div>
          <div class="course-actions">
            <button (click)="onEditCourse(course)" class="btn-edit">âœï¸ Modifier</button>
            <button (click)="onDeleteCourse(course.id!)" class="btn-delete">ğŸ—‘ï¸ Supprimer</button>
            <button (click)="viewCourse(course.id!)" class="btn-view">ğŸ‘ï¸ Voir</button>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>

<!-- ğŸ Footer (identique au template) -->
<footer class="footer">
  <div class="footer-logo">
    <img src="assets/images/logo-white.png" alt="EduLearn Logo">
    <span>EduLearn</span>
  </div>
  <p class="footer-subtitle">Virtual Class for Zoom</p>
  <p>Subscribe to get our Newsletter</p>
  <form class="newsletter-form">
    <input type="email" placeholder="Your Email" class="newsletter-input">
    <button type="submit" class="newsletter-btn">Subscribe</button>
  </form>
  <div class="footer-links">
    <a href="#">Careers</a>
    <a href="#">Privacy Policy</a>
    <a href="#">Terms & Conditions</a>
  </div>
  <p class="footer-copyright">Â© 2025 Class Technologies Inc.</p>
</footer>