<div class="admin-dashboard">
  <!-- Top Navigation with Logout Button -->
  <div class="top-nav">
    <div class="nav-logo">EduLearn Admin</div>
    <div class="nav-actions">
      <span class="user-name">Welcome, {{ userName }}</span>
      <button class="logout-btn" (click)="logout()">Logout</button>
    </div>
  </div>

  <!-- Hero Section -->
  <section class="hero-banner">
    <div class="hero-content">
      <h1>Admin Dashboard</h1>
      <p>Manage your school platform from here.</p>
    </div>
  </section>

  <!-- Success and Error Messages -->
  <div *ngIf="successMessage" class="success-message">
    <p>{{ successMessage }}</p>
  </div>
  
  <div *ngIf="error" class="error-message">
    <p>{{ error }}</p>
  </div>

  <!-- Loading indicator -->
  <div *ngIf="loading" class="loading">
    <p>Loading users...</p>
  </div>

  <!-- Action loading indicator -->
  <div *ngIf="actionLoading" class="action-loading">
    <p>Updating user status...</p>
  </div>

  <!-- Users Section -->
  <section class="users-section" *ngIf="!loading && !error">
    <!-- Teachers Table -->
    <div class="table-container">
      <div class="table-header">
        <h2>Teachers</h2>
        <button class="create-btn" (click)="openCreateTeacherForm()">Create New Teacher</button>
      </div>
      <table class="users-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Username</th>
            <th>Email</th>
            <th>Module</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let teacher of paginatedTeachers">
            <td>{{ teacher.id }}</td>
            <td>{{ teacher.username }}</td>
            <td>{{ teacher.email }}</td>
            <td>{{ teacher.module }}</td>
            <td>
              <span class="status-badge" [ngClass]="{'active': teacher.isActivated, 'inactive': !teacher.isActivated}">
                {{ teacher.isActivated ? 'Active' : 'Inactive' }}
              </span>
            </td>
            <td>
              <button 
                class="toggle-btn" 
                [ngClass]="{'disable-btn': teacher.isActivated, 'enable-btn': !teacher.isActivated}"
                (click)="toggleTeacherActivation(teacher)"
                [disabled]="actionLoading">
                {{ teacher.isActivated ? 'Disable' : 'Enable' }}
              </button>
            </td>
          </tr>
          <tr *ngIf="paginatedTeachers.length === 0">
            <td colspan="6" class="no-data">No teachers found</td>
          </tr>
        </tbody>
      </table>
      
      <!-- Teachers Pagination -->
      <div class="pagination-controls" *ngIf="allTeachers.length > itemsPerPage">
        <button 
          (click)="prevPageTeachers()" 
          [disabled]="currentPageTeachers === 1"
          class="pagination-btn">
          Previous
        </button>
        <span class="pagination-info">
          Page {{ currentPageTeachers }} of {{ getTotalPagesTeachers() }}
        </span>
        <button 
          (click)="nextPageTeachers()" 
          [disabled]="currentPageTeachers === getTotalPagesTeachers()"
          class="pagination-btn">
          Next
        </button>
      </div>
    </div>

    <!-- Students Table -->
    <div class="table-container">
      <div class="table-header">
        <h2>Students</h2>
        <button class="create-btn" (click)="openCreateStudentForm()">Create New Student</button>
      </div>
      <table class="users-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Username</th>
            <th>Email</th>
            <th>Class ID</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let student of paginatedStudents">
            <td>{{ student.id }}</td>
            <td>{{ student.username }}</td>
            <td>{{ student.email }}</td>
            <td>{{ student.classe_id }}</td>
            <td>
              <span class="status-badge" [ngClass]="{'active': student.isActivated, 'inactive': !student.isActivated}">
                {{ student.isActivated ? 'Active' : 'Inactive' }}
              </span>
            </td>
            <td>
              <button 
                class="toggle-btn" 
                [ngClass]="{'disable-btn': student.isActivated, 'enable-btn': !student.isActivated}"
                (click)="toggleStudentActivation(student)"
                [disabled]="actionLoading">
                {{ student.isActivated ? 'Disable' : 'Enable' }}
              </button>
            </td>
          </tr>
          <tr *ngIf="paginatedStudents.length === 0">
            <td colspan="6" class="no-data">No students found</td>
          </tr>
        </tbody>
      </table>
      
      <!-- Students Pagination -->
      <div class="pagination-controls" *ngIf="allStudents.length > itemsPerPage">
        <button 
          (click)="prevPageStudents()" 
          [disabled]="currentPageStudents === 1"
          class="pagination-btn">
          Previous
        </button>
        <span class="pagination-info">
          Page {{ currentPageStudents }} of {{ getTotalPagesStudents() }}
        </span>
        <button 
          (click)="nextPageStudents()" 
          [disabled]="currentPageStudents === getTotalPagesStudents()"
          class="pagination-btn">
          Next
        </button>
      </div>
    </div>
  </section>

  <!-- Create Teacher Modal -->
  <div class="modal" *ngIf="showCreateTeacherForm">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Create New Teacher</h3>
        <span class="close" (click)="closeCreateTeacherForm()">&times;</span>
      </div>
      <div class="modal-body">
        <form (ngSubmit)="createTeacher()" #teacherForm="ngForm">
          <div class="form-group">
            <label for="teacherUsername">Username *</label>
            <input 
              type="text" 
              id="teacherUsername" 
              [(ngModel)]="newTeacher.username" 
              name="teacherUsername" 
              class="form-control" 
              required>
          </div>
          
          <div class="form-group">
            <label for="teacherEmail">Email *</label>
            <input 
              type="email" 
              id="teacherEmail" 
              [(ngModel)]="newTeacher.email" 
              name="teacherEmail" 
              class="form-control" 
              required>
          </div>
          
          <div class="form-group">
            <label for="teacherPassword">Password *</label>
            <input 
              type="password" 
              id="teacherPassword" 
              [(ngModel)]="newTeacher.password" 
              name="teacherPassword" 
              class="form-control" 
              required>
          </div>
          
          <div class="form-group">
            <label for="teacherModule">Module</label>
            <input 
              type="text" 
              id="teacherModule" 
              [(ngModel)]="newTeacher.module" 
              name="teacherModule" 
              class="form-control">
          </div>
          
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" (click)="closeCreateTeacherForm()" [disabled]="actionLoading">
              Cancel
            </button>
            <button type="submit" class="btn btn-primary" [disabled]="actionLoading">
              {{ actionLoading ? 'Creating...' : 'Create Teacher' }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Create Student Modal -->
  <div class="modal" *ngIf="showCreateStudentForm">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Create New Student</h3>
        <span class="close" (click)="closeCreateStudentForm()">&times;</span>
      </div>
      <div class="modal-body">
        <form (ngSubmit)="createStudent()" #studentForm="ngForm">
          <div class="form-group">
            <label for="studentUsername">Username *</label>
            <input 
              type="text" 
              id="studentUsername" 
              [(ngModel)]="newStudent.username" 
              name="studentUsername" 
              class="form-control" 
              required>
          </div>
          
          <div class="form-group">
            <label for="studentEmail">Email *</label>
            <input 
              type="email" 
              id="studentEmail" 
              [(ngModel)]="newStudent.email" 
              name="studentEmail" 
              class="form-control" 
              required>
          </div>
          
          <div class="form-group">
            <label for="studentPassword">Password *</label>
            <input 
              type="password" 
              id="studentPassword" 
              [(ngModel)]="newStudent.password" 
              name="studentPassword" 
              class="form-control" 
              required>
          </div>
          
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" (click)="closeCreateStudentForm()" [disabled]="actionLoading">
              Cancel
            </button>
            <button type="submit" class="btn btn-primary" [disabled]="actionLoading">
              {{ actionLoading ? 'Creating...' : 'Create Student' }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Modal Background Overlay -->
  <div class="modal-overlay" *ngIf="showCreateTeacherForm || showCreateStudentForm" (click)="closeCreateTeacherForm(); closeCreateStudentForm()"></div>
</div>